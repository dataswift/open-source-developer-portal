<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>HAT File Storage | Hub of All Things API</title><meta name=description content="HAT File Storage"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/main.e9aa.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Roboto+Slab:300|Open+Sans:300,400,600,700"><script src=/js/head-scripts.e78f.js></script><script src=https://cdn.statuspage.io/se-v2.js></script><!-- Code highlighting --><link rel=stylesheet href=/lib/code-highlight/styles/atom-one-dark.css><script src=/lib/code-highlight/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></head><body><!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><header><div class="header__primary js-two-col-header-primary"><div class=page-wrap><div><a href=https://www.hubofallthings.com class="logo icon-logo-hat-white">Hub of All Things</a><div class=hamburger><a href="https://hubofallthings.com/main/what-is-the-hat/">What is the HAT</a> <a class="btn primary js-hamburger">Menu</a></div></div><nav class=js-hamburger-nav><a href="https://www.hatdex.org/">Data Exchange</a> <a href="https://hatcommunity.org/">Community Foundation</a> <a href="/">Developers</a> <a href="https://hatresearch.org/">Research</a> <a href="https://innovation.hubofallthings.com/">Innovation</a> <a class="btn primary" href="https://hubofallthings.com/">Learn More</a></nav></div></div><nav class="header__secondary js-two-col-nav-toggle"><div class=js-two-col-header-secondary><div class=page-wrap><a href="/home/">Resources</a> <a href="/guides/">Guides</a> <a href="/documentation/" class=active>API docs</a><!-- <a href="/tutorials/" >Tutorials</a> --> <a href=https://github.com/Hub-of-all-Things class="no-nav js-two-col-no-toggle">Repositories</a><div class="custom-select custom-select--blue js-global-language-select"><select name=select class=js-language-select><option value=raw>raw</option><option value=php>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div></div></nav></header><div class=content><div class=cnt-two-col><div class=page-wrap><section class="cnt-two-col__nav js-two-col-nav"><div class=close><button class="js-two-col-nav-close icon-cnt-two-col-close"></button></div><div class=language-picker><h6>Language</h6><div class="custom-select custom-select--blue"><select class=js-language-select name=select><option value=raw>raw</option><option value=php selected>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div><!-- nav elements below should be in the same order of the secondary navigation --><nav class="side-nav js-side-nav"><section><h6>Knowing the HAT Tech Ecosystem</h6><ul><li><a href=/home/knowing/1_knowing_ecosystem.html>Knowing the Ecosystem</a><ul></ul></li><li><a href=/home/knowing/2_hat_users.html>HAT Users</a><ul></ul></li><li><a href=/home/knowing/3_hat_application.html>HAT Application</a><ul></ul></li><li><a href=/home/knowing/4_hat_community_foundation.html>HAT Community Foundation</a><ul></ul></li><li><a href=/home/knowing/5_hatdex.html>HATDeX</a><ul></ul></li><li><a href=/home/knowing/hat_platform_process_architecture.html>The Architecture Diagram</a><ul></ul></li></ul><h6>Tools</h6><ul><li><a href=/home/tools/api.html>API</a><ul></ul></li><li><a href=/home/tools/HAT_core.html>HAT Core</a><ul></ul></li><li><a href=/home/tools/rumpel.html>Rumpel</a><ul></ul></li><li><a href=/home/tools/rumpellite.html>RumpelLite</a><ul></ul></li><li><a href=/home/tools/data_plugs.html>Data Plugs</a><ul></ul></li><li><a href=/home/tools/marketsquare.html>MarketSquare</a><ul></ul></li><li><a href=/home/tools/off_the_shelf_hats.html>Off-the-shelf HATs</a><ul></ul></li></ul><h6>HAT Certification</h6><ul><li><a href=/home/hat_applications/index.html>HAT Applications</a><ul><li><a href=/home/hat_applications/rating_scheme_best_practice.html>Rating Scheme Best Practice</a></li><li><a href=/home/hat_applications/rating_scheme.html>Rating Scheme</a></li></ul></li><li><a href=/home/hat_service_provider/index.html>HAT Service Provider</a><ul><li><a href=/home/hat_service_provider/security_requirement_best_practice.html>Security Requirement Best Practice</a></li><li><a href=/home/hat_service_provider/security_requirement.html>Security Requirement</a></li></ul></li></ul><h6>Why the HAT?</h6><ul><li><a href=/home/why/what_is_hat.html>Why the HAT?</a><ul></ul></li><li><a href=/home/why/what_can_you_make.html>What can you make on the HAT?</a><ul></ul></li><li><a href=/home/why/why_build_something_on_the_hat.html>Why build something on the HAT?</a><ul></ul></li><li><a href=/home/why/some_cool_apps.html>Some cool apps</a><ul></ul></li></ul></section><section class=side-nav__options style=display:none><h6>Other Resources</h6><ul><li class=external-link><a href=https://hatters.hubofallthings.com target=_blank><span class=icon-sidenav-option>Get a HAT</span></a></li><li class=external-link><a href=http://forum.hatcommunity.org/c/developers target=_blank><span class=icon-sidenav-option>Developer Forum</span></a></li></ul></section></nav><nav class="side-nav js-side-nav active"><section><h6>API v2</h6><ul><li><a href=/documentation/authentication-v2.html>Authentication</a><ul></ul></li><li><a href=/documentation/bundles-v2.html>Bundles</a><ul><li><a href=/documentation/bundles-v2/retrieve_registered_bundle_data.html>Retrieve Registered Bundle Data</a></li><li><a href=/documentation/bundles-v2/propose_data_bundles.html>Propose Data Bundles</a></li></ul></li><li><a href=/documentation/combinators-v2.html>Combinators</a><ul><li><a href=/documentation/combinators-v2/get_data.html>Propose Data Bundles</a></li><li><a href=/documentation/combinators-v2/propose_endpoint.html>Propose A New data Endpoint</a></li></ul></li><li><a href=/documentation/data-v2.html>Data</a><ul><li><a href=/documentation/data-v2/bulk_upload.html>Bulk-upload a large chunk of data to the same endpoint</a></li><li><a href=/documentation/data-v2/delete_a_record.html>Delete A Record</a></li><li><a href=/documentation/data-v2/filter_data_records.html>Filter data records up to a maximum number</a></li><li><a href=/documentation/data-v2/get_data_records.html>Data Records</a></li></ul></li><li><a href=/documentation/data_debits-v2.html>Data Debits</a><ul><li><a href=/documentation/data_debits-v2/update_a_data_debit.html>Update a data debit</a></li><li><a href=/documentation/data_debits-v2/disable_a_data_debit_copy.html>Disable a Data Debit</a></li><li><a href=/documentation/data_debits-v2/enable_a_data_debit.html>Enable a Data Debit</a></li><li><a href=/documentation/data_debits-v2/get_data_debit_values.html>Get Data Debit values</a></li><li><a href=/documentation/data_debits-v2/propose_a_data_debit.html>Propose a Data Debit</a></li></ul></li><li><a href=/documentation/file_storage-v2.html class=active>HAT File Storage</a><ul></ul></li><li><a href=/documentation/linked_data-v2.html>Linked Data</a><ul><li><a href=/documentation/linked_data-v2/save_an_example_record.html>Save an example notable record</a></li><li><a href=/documentation/linked_data-v2/batch_data_upload.html>Batch data upload</a></li><li><a href=/documentation/linked_data-v2/save_an_example_nudge.html>Save an example nudge</a></li><li><a href=/documentation/linked_data-v2/link_up_data_records.html>Link up data records</a></li><li><a href=/documentation/linked_data-v2/new_endpoint.html>New endpoint for linked data retrieval</a></li><li><a href=/documentation/linked_data-v2/retireve_linked_data.html>Retrieve linked data points as per registered endpoint</a></li></ul></li></ul><h6>API v1 - Deprecated</h6><ul><li><a href=/documentation/raw_data_input_and_output.html>Raw Data Input and Output</a><ul><li><a href=/documentation/raw_data_input_and_output/data_field.html>Data Field</a></li><li><a href=/documentation/raw_data_input_and_output/data_sources.html>Data Sources</a></li><li><a href=/documentation/raw_data_input_and_output/data_tables.html>Data Tables</a></li><li><a href=/documentation/raw_data_input_and_output/data_value.html>Data Value</a></li><li><a href=/documentation/raw_data_input_and_output/retrieving_raw_data.html>Retrieving Raw Data</a></li></ul></li><li><a href=/documentation/sharing_and_direct_data_debits.html>Sharing and Direct Data Debits</a><ul></ul></li><li><a href=/documentation/user_management.html>User Management</a><ul><li><a href=/documentation/user_management/authentication.html>Authentication</a></li><li><a href=/documentation/user_management/direct_data_credit_and_debit_accounts.html>Direct Data Credit and Debit Accounts</a></li></ul></li></ul></section></nav><nav class="side-nav js-side-nav"><section id=js-sidenav-dropdown class=side-nav__dropdown><h6>Choose a guide</h6><div class=picker id=js-sidenav-dropdown-button><button>Please Select a Guide</button><div class="icon icon-side-nav-collapse-plus"></div><div class="icon icon-side-nav-collapse-minus"></div></div><nav id=js-sidenav-dropdown-nav><a href=/guides/provisioning>Provisioning</a> <a href=/guides/dex>Data Exchange Services</a> <a href=/guides/file-storage>File Storage</a></nav></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/provisioning>Overview: Provisioning</a><div class=dot></div></li><li><a href=/guides/provisioning/01-sign-up.html>Step 1 - Sign user up with Milliner</a><div class=dot></div></li><li><a href=/guides/provisioning/02-create-hat.html>Step 2 - Create the HAT</a><div class=dot></div></li><li><a href=/guides/provisioning/03-register-hat.html>Step 3 - Register HAT with DEX</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/dex>Overview: Data Exchange Services</a><div class=dot></div></li><li><a href=/guides/dex/01-statistics.html>DEX Statistics</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/file-storage>Overview: File Storage</a><div class=dot></div></li><li><a href=/guides/file-storage/01-upload.html>Step 1 - File Upload</a><div class=dot></div></li><li><a href=/guides/file-storage/02-access-management.html>Step 2 - Access Management</a><div class=dot></div></li><li><a href=/guides/file-storage/03-contents.html>Step 3 - Content Access</a><div class=dot></div></li><li><a href=/guides/file-storage/04-search.html>Step 4 - File lookup/search</a><div class=dot></div></li></ol></section><section class=side-nav__options style=display:none><h6>API Resources</h6><ul><li class=external-link><a href=https://documenter.getpostman.com/view/110376/hat-rich-data-api-showcase/6YySZS7 target=_blank><span class=icon-sidenav-option>API v2 reference docs</span></a></li><li class=external-link><a href="http://hub-of-all-things.github.io/doc/" target=_blank><span class=icon-sidenav-option>API v2 reference docs</span></a></li></ul></section></nav><nav class="side-nav js-side-nav"><section><ul><li><a href=/tutorials/how_long_will_it_take_to_create_something_on_the_hat.html>How Long Will it Take to Create Something on the HAT?</a><ul></ul></li><li><a href=/tutorials/how_to_build_a_data_plug.html>How to Build a Data Plug</a><ul></ul></li><li><a href=/tutorials/tutorials_on_using_the_hat.html>Tutorials on using the HAT</a><ul></ul></li></ul></section></nav></section><section class=cnt-two-col__content><h1 id=hat-file-storage>HAT File Storage</h1><p>File storage is a rather different beast from structured (meta)data about your personal digital life:</p><ul><li>they are big to store</li><li>sending them back and forth requires a lot of bandwidth</li><li>databases very useful for storing structured data are not well-suited for storing files</li><li>data in a file can not normally be sliced and diced as structured metadata could</li><li>files would often be uploaded from a low-bandwidth (e.g. mobile) device that is likely to have intermittent connectivity</li></ul><p>These considerations further play with the requirements for file storage to be reliable, secure and cost-efficient especially if we want to make HATs affordable. And we still want to be able to attach metadata to files, maintain fine-granularity access control.</p><p>APIs are also rather different from web pages in terms of how file uploads tend to be or can be handled. Not going into a lot of detail here there are plenty of reasons why <a href="https://philsturgeon.uk/api/2016/01/04/http-rest-api-file-uploads/">uploading using multipart forms mostly sucks</a> as well as pretty good examples on how file uploads could be done, e.g. <a href=https://developers.google.com/youtube/v3/guides/using_resumable_upload_protocol>YouTube Resumable Uploads</a>. As a building block to satisfy all the requirements we picked AWS S3</p><h2 id=uploads>Uploads</h2><p>File upload happens in three steps:</p><ol><li>Posting file metadata to the HAT and retrieving URL to send the file to directly</li><li>Directly uploading the file to the (securely signed) URL</li><li>Marking the file complete at the HAT</li></ol><p>Uploading metadata is simple: call <code>POST /api/v2/files/upload</code> with the file details:</p><div class="code-snippet js-code-snippet language-curl"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-curl data-lang=curl>   curl -X POST -H "Accept: application/json" -H "X-Auth-Token: ${HAT_AUTH_TOKEN}" \
        -H "Content-Type: application/json" \
        -d '{
            "name": "testFile.png",
            "source": "test",
            "tags": ["tag1", "tag2"],
            "title": "test Title",
            "description": "a very interesting test file",
        }' \
        "https://${HAT_ADDRESS}/api/v2/files/upload"
</code></pre></div></div><p>Only <code>name</code> and <code>source</code> properties are mandatory - all others are optional. You can also attach <code>dateCreated</code> and <code>lastUpdated</code> fields with Unix timestamps to set them accordingly. If everything is successful, the HAT will respond with a copy of the metadata as well as additional information:</p><div class="code-snippet js-code-snippet language-"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language- data-lang=""><span class=p>{</span><span class=w>
  </span><span class=nt>"fileId"</span><span class=p>:</span><span class=w> </span><span class=s2>"testtestfile-12.png"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"testFile.png"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"source"</span><span class=p>:</span><span class=w> </span><span class=s2>"test"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"tags"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>"tag1"</span><span class=p>,</span><span class=w> </span><span class=s2>"tag2"</span><span class=p>],</span><span class=w>
  </span><span class=nt>"title"</span><span class=p>:</span><span class=w> </span><span class=s2>"test Title"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"description"</span><span class=p>:</span><span class=w> </span><span class=s2>"a very interesting test file"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"dateCreated"</span><span class=p>:</span><span class=w> </span><span class=mi>1487871142325</span><span class=p>,</span><span class=w>
  </span><span class=nt>"lastUpdated"</span><span class=p>:</span><span class=w> </span><span class=mi>1487871142329</span><span class=p>,</span><span class=w>
  </span><span class=nt>"status"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
    </span><span class=nt>"status"</span><span class=p>:</span><span class=w> </span><span class=s2>"New"</span><span class=w>
  </span><span class=p>},</span><span class=w>
  </span><span class=nt>"contentUrl"</span><span class=p>:</span><span class=w> </span><span class=s2>"https://hat-storage-test.s3.amazonaws.com/HAT_ADDRESS/testtestfile-12.png?AWSAccessKeyId=AKIAJSOXH3FJPB43SWGQ&amp;Expires=1487871442&amp;Signature=CTRdDW8nKBqNcuwK0ssH77zjkec%3D"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"contentPublic"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w>
  </span><span class=nt>"permissions"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w>
    </span><span class=p>{</span><span class=w>
      </span><span class=nt>"userId"</span><span class=p>:</span><span class=w> </span><span class=s2>"694dd8ed-56ae-4910-abf1-6ec4887b4c42"</span><span class=p>,</span><span class=w>
      </span><span class=nt>"contentReadable"</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
    </span><span class=p>}</span><span class=w>
  </span><span class=p>]</span><span class=w>
</span><span class=p>}</span><span class=w>
</span></code></pre></div></div><p>Importantly, it includes the unique file identifier for the HAT <code>fileId</code> and <code>contentUrl</code> indicating where the file should be uploaded. The upload <code>contentUrl</code> is signed and has limited duration validity, most likely 5 minutes, after which it becomes invalid. Then uploading itself could be done as (<em>note:</em> <code>x-amz-server-side-encryption</code> header is mandatory):</p><div class="code-snippet js-code-snippet language-curl"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-curl data-lang=curl>curl -v -T ${LOCAL_FILE} \
  -H "x-amz-server-side-encryption: AES256"\
  "https://hat-storage-test.s3.amazonaws.com/HAT_ADDRESS/testtestfile-12.png?AWSAccessKeyId=AKIAJSOXH3FJPB43SWGQ&amp;Expires=1487871442&amp;Signature=CTRdDW8nKBqNcuwK0ssH77zjkec%3D"
</code></pre></div></div><p>Finally, to mark the file &ldquo;Completed&rdquo;, call <code>PUT /api/v2/files/file/:fileId/complete</code>. It will again respond with file metadata:</p><div class="code-snippet js-code-snippet language-"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language- data-lang=""><span class=p>{</span><span class=w>
  </span><span class=nt>"fileId"</span><span class=p>:</span><span class=w> </span><span class=s2>"postmantestfile-12.png"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"name"</span><span class=p>:</span><span class=w> </span><span class=s2>"testFile.png"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"source"</span><span class=p>:</span><span class=w> </span><span class=s2>"postman"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"tags"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>"tag1"</span><span class=p>,</span><span class=w> </span><span class=s2>"tag2"</span><span class=p>],</span><span class=w>
  </span><span class=nt>"title"</span><span class=p>:</span><span class=w> </span><span class=s2>"test Title"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"description"</span><span class=p>:</span><span class=w> </span><span class=s2>"a very interesting test file"</span><span class=p>,</span><span class=w>
  </span><span class=nt>"dateCreated"</span><span class=p>:</span><span class=w> </span><span class=mi>1487871142325</span><span class=p>,</span><span class=w>
  </span><span class=nt>"lastUpdated"</span><span class=p>:</span><span class=w> </span><span class=mi>1487871142329</span><span class=p>,</span><span class=w>
  </span><span class=nt>"status"</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
    </span><span class=nt>"size"</span><span class=p>:</span><span class=w> </span><span class=mi>154639</span><span class=p>,</span><span class=w>
    </span><span class=nt>"status"</span><span class=p>:</span><span class=w> </span><span class=s2>"Completed"</span><span class=w>
  </span><span class=p>},</span><span class=w>
  </span><span class=nt>"contentPublic"</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=p>,</span><span class=w>
  </span><span class=nt>"permissions"</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w>
    </span><span class=p>{</span><span class=w>
      </span><span class=nt>"userId"</span><span class=p>:</span><span class=w> </span><span class=s2>"694dd8ed-56ae-4910-abf1-6ec4887b4c42"</span><span class=p>,</span><span class=w>
      </span><span class=nt>"contentReadable"</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
    </span><span class=p>}</span><span class=w>
  </span><span class=p>]</span><span class=w>
</span><span class=p>}</span><span class=w>
</span></code></pre></div></div><p>File <code>status</code> has now been marked as <code>Completed</code> and also contains file size in bytes! The request will fail if the file doesn&rsquo;t exist, hasn&rsquo;t been fully uploaded or you do not have permissions to mark the file completed (you will if you started the upload in the first place).</p><p>Finally, files can be deleted (by <em>owner</em> only!) by calling <code>DELETE /api/v2/files/file/:fileId</code></p><h2 id=viewing-contents>Viewing contents</h2><ul><li><code>GET api/v2/files/file/:fileId</code> to list metadata of a file, including <code>contentUrl</code> pointing to a pre-signed temporary URL for file contents if the user is permitted file access</li><li><code>GET /api/v2/files/content/:fileId</code> to get contents of a file if file is marked publicly accessible or the client is permitted file content access. The endpoint redirects to the pre-signed temporary content URL or returns 404 error code (Not Found) if the file does not exist or is not accessible</li></ul><h2 id=access-control>Access Control</h2><p>HAT owner can access all files, but otherwise there are three options for file access:</p><ul><li>another HAT user can be marked to have access to file&rsquo;s metadata</li><li>another HAT user can be marked to have access to both file&rsquo;s metadata and contents</li><li>a file can be marked to have its contents publicly accessible (e.g. publishing photos or your book!)</li></ul><p>By default, the user who saved the file onto the HAT is allowed to see the file&rsquo;s metadata and contents, but only the <code>owner</code> can adjust file permissions by:</p><ul><li>calling <code>GET /api/v2/files/allowAccess/:fileId/:userId</code> to allow a specific user (<code>:userId</code>) to access a specific file (<code>:fileId</code>), optionally setting <code>content</code> query parameter to <code>true</code>/<code>false</code> to control content access (<code>false</code> by default). Conversely, calling <code>GET /api/v2/files/restrictAccess/:fileId/:userId</code> to restrict access.</li><li>calling <code>POST /api/v2/files/allowAccess/:userId</code> sending file template to grant access to a set of files (same syntax as for file search!). Conversely, calling <code>POST /api/v2/files/restrictAccess/:userId</code> to restrict access.</li><li>calling <code>GET /api/v2/files/allowAccessPublic/:fileId</code> and <code>GET /api/v2/files/restrictAccessPublic/:fileId</code> to control public file access</li></ul><h2 id=search>Search</h2><p>HAT files can be looked up by any part of metadata attached to them:</p><ul><li><code>fileId</code> for an exact match, where one or no files are returned</li><li><code>name</code> for an exact match on the original name, but multiple files could potentially be returned. <em>Empty</em> string if you do not want to match against <code>name</code></li><li><code>source</code> matching all files from a specific source such as <code>facebook</code>. <em>Empty</em> string if you do not want to match against <code>source</code></li><li><code>tags</code> a set of all tags matching files need to have attached</li><li><code>title</code> and <code>description</code> for an approximate, text-based search matching the fields</li><li><code>status</code> to filter e.g. only files that are marked <code>Completed</code></li></ul><p>To search for files call <code>POST /api/v2/files/search</code> sending file template to match against. All calls must be authenticated with the user&rsquo;s token and only files the user is allowed to access are returned (all files for the HAT owner!):</p><div class="code-snippet js-code-snippet language-curl"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-curl data-lang=curl>    curl -X POST -H "Accept: application/json" -H "X-Auth-Token: ${HAT_AUTH_TOKEN}" \
        -H "Content-Type: application/json" \
        -d '{
            "name": "testFile.png",
            "source": "test",
            "tags": ["tag1", "tag2"],
            "title": "test Title",
            "description": "a very interesting test file",
            "status": { "status": "Completed", "size": 0}
        }' \
        "https://${HAT_ADDRESS}/api/v2/files/search"
</code></pre></div></div><hr><section class=copyright><div class=page-wrap><div><span>Â© 2017 HAT Data Exchange Ltd.</span> <a href=/sitemap>Sitemap</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="https://hubofallthings.com/main/cookie-policy/">Cookie Policy</a></div></div></section></section></div></div></div><script src=//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script>window.jQuery || document.write('<script src="/_bower_components/jquery/jquery.min.js"><\/script>')</script><script src=/js/script.f334.js></script></body></html>