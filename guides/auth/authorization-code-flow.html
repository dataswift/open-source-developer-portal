<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Dwolla OAuth 2.0 | Dwolla API</title><meta name=description content="Obtain an OAuth access token, used to access data in the Dwolla API on behalf of a user or application."><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/main.2ea9.css><link rel=stylesheet href="//fonts.googleapis.com/css?family=Roboto+Slab:300|Open+Sans:300,400,600,700"><script src=/js/head-scripts.3bcb.js></script><script src=https://cdn.statuspage.io/se-v2.js></script></head><body><!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><header><div class="header__primary js-two-col-header-primary"><div class=page-wrap><div><a href=https://www.dwolla.com class="logo icon-logo-dwolla-white">Dwolla</a><div class=hamburger><a href="https://www.dwolla.com/contact?b=nav">Let's talk</a> <a class="btn primary js-hamburger">Menu</a></div></div><nav class=js-hamburger-nav><a href=https://www.dwolla.com/about>Product</a> <a href="/">Developer</a> <a href=https://www.dwolla.com/login>Log in</a> <a href=https://accounts.dwolla.com/interest>Sign up</a> <a class="btn primary" href="https://www.dwolla.com/contact?b=nav">Let's talk</a></nav></div></div><nav class="header__secondary js-two-col-nav-toggle"><div class=js-two-col-header-secondary><div class=page-wrap><a href="/guides/" class=active>Guides</a> <a href="/resources/">Resources</a> <a href="https://docsv2.dwolla.com/">API docs</a> <a href=/pages/sdks.html class="no-nav js-two-col-no-toggle">SDKs</a><div class="custom-select custom-select--blue js-global-language-select"><select name=select class=js-language-select><option value=raw>raw</option><option value=php>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div></div></nav></header><div class=content><div class=cnt-two-col><div class=page-wrap><section class="cnt-two-col__nav js-two-col-nav"><div class=close><button class="js-two-col-nav-close icon-cnt-two-col-close"></button></div><div class=language-picker><h6>Language</h6><div class="custom-select custom-select--blue"><select class=js-language-select name=select><option value=raw>raw</option><option value=php selected>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div><!-- nav elements below should be in the same order of the secondary navigation --><nav class="side-nav js-side-nav active"><section id=js-sidenav-dropdown class=side-nav__dropdown><h6>Choose a guide</h6><div class=picker id=js-sidenav-dropdown-button><button>Dwolla OAuth 2.0</button><div class="icon icon-side-nav-collapse-plus"></div><div class="icon icon-side-nav-collapse-minus"></div></div><nav id=js-sidenav-dropdown-nav><a href="/guides/sandbox-setup/">Getting started in Sandbox</a> <a href="/guides/send-money/">Send money to your users</a> <a href="/guides/receive-money/">Receive money from your users</a> <a href="/guides/transfer-money-between-users/">Transfer money between users</a> <a href="/guides/webhooks/">Webhooks</a> <a href="/guides/migrate-to-v2/">Migrate to v2</a></nav></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/send-money>Overview: Send money to your users</a><div class=dot></div><ol><li><a href=/guides/send-money/01-white-label-onboarding.html>Option 1: White label</a><div class=dot></div></li><li><a href=/guides/send-money/01-direct-onboarding.html>Option 2: Dwolla Direct</a><div class=dot></div></li></ol></li><li><a href=/guides/send-money/02-fetch-funding-sources.html>Fetch funding sources</a><div class=dot></div></li><li><a href=/guides/send-money/03-create-transfer.html>Create a transfer</a><div class=dot></div></li><li><a href=/guides/send-money/04-check-transfer.html>Check transfer status</a><div class=dot></div></li></ol></section><!-- <section class="side-nav__options" style="display:none">
    <h6>Options</h6>
    <ul>
        <li class="external-link"><a href="https://developers.dwolla.com/dev/pages/guides/masspay" target="_blank"><span class="icon-sidenav-option">MassPay V1</span></a></li>
        <li class="external-link"><a href=""><span class="icon-sidenav-option">Recurring and Scheduled V1</span></a></li>
    </ul>
</section> --><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/receive-money>Overview</a><div class=dot></div><ol><li><a href=/guides/receive-money/01-white-label-onboarding.html>Option 1: White label</a><div class=dot></div></li><li><a href=/guides/receive-money/01-direct-onboarding.html>Option 2: Dwolla Direct</a><div class=dot></div></li></ol></li><li><a href=/guides/receive-money/02-check-transfer.html>Check transfer status</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/webhooks>Overview: Webhooks</a><div class=dot></div></li><li><a href=/guides/webhooks/01-obtain-authorization.html class=active>Obtain authorization</a><div class=dot></div></li><li><a href=/guides/webhooks/02-create-subscription.html>Create a webhook subscription</a><div class=dot></div></li><li><a href=/guides/webhooks/03-validating-webhooks.html>Validating webhooks</a><div class=dot></div></li><li><a href=/guides/webhooks/04-process-webhooks.html>Processing webhooks</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/transfer-money-between-users>Overview: transfer money between your users</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/01-access-token.html class=active>Generate an access token</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/02-create-verified-customer.html>Create a verified customer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/03-attach-unverified-bank.html>Attach an unverified funding source</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/04-create-unverified-customer.html>Create an unverified Customer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/05-attach-verified-bank.html>Attach a verified funding source</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/06-create-transfer.html>Create a transfer</a><div class=dot></div></li><li><a href=/guides/transfer-money-between-users/07-check-transfer.html>Check the status of your transfer</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>Follow the steps</h6><ol><li><a href=/guides/migrate-to-v2>Overview: Migrate to v2</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/01-api-v2-principles.html class=active>API v2 principles</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/02-making-requests.html>Making requests</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/03-authentication.html>Authentication</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/04-sdk-support.html>SDK support</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/05-v1-to-v2-endpoint-changes.html>v1 to v2 endpoint changes</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/06-other-notable-changes.html>Other notable changes</a><div class=dot></div></li><li><a href=/guides/migrate-to-v2/07-faq.html>FAQ</a><div class=dot></div></li></ol></section><section class=steps-nav><h6>In this guide</h6><ol><li><a href=/guides/auth>Overview: Dwolla OAuth 2.0</a><div class=dot></div></li><li><a href=/guides/auth/authorization-code-flow.html class=active>Authorization code flow (Co-branded)</a><div class=dot></div><ol><li><a href=/guides/auth/oauth-account-creation.html>OAuth account creation</a><div class=dot></div></li></ol></li><li><a href=/guides/auth/client-credentials-flow.html>Client credentials flow (White Label and/or Webhooks)</a><div class=dot></div></li><li><a href=/guides/auth/using-an-access-token.html>Using an access token</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/offsite-gateway>Overview: Off-Site Gateway</a><div class=dot></div></li><li><a href=/guides/offsite-gateway/direct-submit.html class=active>Direct submit option</a><div class=dot></div></li><li><a href=/guides/offsite-gateway/server-to-server.html>Server-to-server option</a><div class=dot></div></li></ol></section><section class=side-nav__options><h6>API v1 Resources</h6><ul><li><a href="/guides/offsite-gateway/"><span>Off-Site Gateway</span></a></li><li class=external-link><a href="https://docs.dwolla.com/" target=_blank><span class=icon-sidenav-option>API v1 reference docs</span></a></li></ul></section></nav><nav class="side-nav js-side-nav"><section><h6>Tools</h6><ul><li><a href=/resources/sandbox-console.html>Sandbox Console</a></li><li><a href=/resources/token-generator.html>Token generator</a></li><li><a href=/resources/changelog.html>Change log</a></li><li class=external-link><a href="http://status.dwolla.com/" target=_blank><span class=icon-sidenav-option>Status</span></a></li></ul><h6>Articles</h6><ul><li><a href=/resources/account-types.html>Account types</a><ul><li><a href=/resources/account-types/traditional-accounts.html>Traditional accounts</a></li><li><a href=/resources/account-types/white-label-accounts.html>White Label accounts</a></li></ul></li><li><a href=/resources/bank-transfer-workflow.html>Bank transfer workflow</a><ul><li><a href=/resources/bank-transfer-workflow/processing-times.html>Processing times</a></li><li><a href=/resources/bank-transfer-workflow/transfer-failures.html>Transfer failures</a></li></ul></li><li><a href=/resources/customer-verification.html>Customer verification</a><ul><li><a href=/resources/customer-verification/personal-verified-customers.html>Personal verified Customers</a></li><li><a href=/resources/customer-verification/business-verified-customers.html>Business verified Customers</a></li><li><a href=/resources/customer-verification/handling-verification-statuses.html>Handling verification statuses</a></li></ul></li><li><a href=/resources/dwolla-js.html>Dwolla.js</a><ul><li><a href=/resources/dwolla-js/add-a-bank-account.html>Add a bank account</a></li><li><a href=/resources/dwolla-js/instant-account-verification.html>Instant account verification</a></li><li><a href=/resources/dwolla-js/on-demand-bank-transfers.html>On-demand bank transfers</a></li></ul></li><li><a href=/resources/facilitator-fee.html>Facilitator Fee</a><ul></ul></li><li><a href=/resources/funding-source-verification.html>Funding source verification</a><ul><li><a href=/resources/funding-source-verification/micro-deposit-verification.html>Micro-deposit verification</a></li><li><a href=/resources/funding-source-verification/instant-account-verification.html>Instant account verification</a></li></ul></li><li><a href=/resources/oauth-refresh-strategies.html>OAuth refresh strategies</a><ul><li><a href=/resources/oauth-refresh-strategies/preemptively-refresh.html>Preemptively refresh authorization</a></li><li><a href=/resources/oauth-refresh-strategies/refresh-on-demand.html>Refresh on-demand</a></li><li><a href=/resources/oauth-refresh-strategies/refresh-best-practices.html>Refresh best practices</a></li></ul></li><li><a href=/resources/testing.html>Testing</a><ul></ul></li></ul></section><section class=side-nav__options style=display:none><h6>API v1 Resources</h6><ul><li><a href="/guides/offsite-gateway/"><span>Off-site Gateway</span></a></li><li class=external-link><a href="https://docs.dwolla.com/" target=_blank><span class=icon-sidenav-option>API v1 reference docs</span></a></li></ul></section></nav><nav class="side-nav js-side-nav"><section id=js-sidenav-dropdown class=side-nav__dropdown><ul><li><a href=https://docsv2.dwolla.com/#introduction>Introduction</a></li><li><a href=https://docsv2.dwolla.com/#oauth>OAuth</a></li><li><a href=https://docsv2.dwolla.com/#customers>Customers</a></li><li><a href=https://docsv2.dwolla.com/#documents>Documents</a></li><li><a href=https://docsv2.dwolla.com/#sources>Funding Sources</a></li><li><a href=https://docsv2.dwolla.com/#transfers>Transfers</a></li><li><a href=https://docsv2.dwolla.com/#events>Events</a></li><li><a href=https://docsv2.dwolla.com/#subscriptions>Webhook Subscriptions</a></li><li><a href=https://docsv2.dwolla.com/#webhooks>Webhooks</a></li></ul></section></nav></section><section class=cnt-two-col__content><h2>Overview - Obtaining an account access token</h2><p>The <a href=https://tools.ietf.org/html/rfc6749#section-4.1>authorization code</a> flow is the most common OAuth flow and is used when an application is wanting to obtain permission to act on behalf of a user. This is a redirection-based flow where the user (Resource owner) is sent from your application to Dwolla (typically in a web-browser) to authenticate and authorize your app. Once the user grants authorization, Dwolla (the Authorization Server) will redirect them back to your application where you&rsquo;ll exchange a temporary authorization code for an account <code>access_token</code> and <code>refresh_token</code> pair. An account access token can then be used to make calls like transfer money, add funding sources, and more to the Dwolla API on behalf of the user.</p><p><strong>OAuth account creation:</strong> If the user does not yet have a Dwolla account they are given the option to sign up before granting permission using Dwolla&rsquo;s <a href=/guides/auth/oauth-account-creation.html>OAuth account creation</a> experience.</p><blockquote><p><strong>Important:</strong> Dwolla’s implementation of the OAuth 2.0 standard uses short-lived access tokens and long-lived refresh tokens. A refresh token is paired with an access token and can be used within 60 days to generate a new access token and refresh token pair. Learn more on how to refresh authorization towards the end of this guide.</p></blockquote><h4>Scopes</h4><p>Before sending a user through the OAuth flow, you must explicitly specify which access scopes you will require. This helps users better understand what kind of data your application wishes to access, and which permissions they are granting your application. Multiple scopes may be included in your authorization request using the pipe (&ldquo;|&rdquo;) character (e.g. scope=send|transactions).</p><p>Requested scopes must also be enabled on your application settings, otherwise Dwolla will respond with an error stating that your application requested invalid scopes.</p><table><thead><tr><th>Scope Name</th><th>Description</th></tr></thead><tbody><tr><td>Transactions</td><td>Access the user&rsquo;s transfer data.</td></tr><tr><td>Send</td><td>Transfer money on the user&rsquo;s behalf.</td></tr><tr><td>Funding</td><td>Access names of funding sources the user has connected to Dwolla, access available balance information for Dwolla Balance, add new funding sources, verify funding sources, initiate transfers to and from funding sources.</td></tr><tr><td>ManageCustomers</td><td>Includes create Customers, manage their funding sources, and allow related money movement.<br><strong>Note:</strong> This is a privileged scope available within our <a href="https://www.dwolla.com/white-label?b=apidocs">White Label API</a> (v2). While fully available in our testing environment, White Label integrations will not be permitted to launch in production without first agreeing to a paid contract. <a href="https://www.dwolla.com/contact?b=apidocs">Contact sales</a> to learn more.</td></tr></tbody></table><hr><h2>Step 1: Request user authorization</h2><p>Generate a URL which describes the permissions your application requires (<code>scope</code>), who the client application is (<code>client_id</code>), and where the user should be redirected to after they grant or deny permissions to your application (<code>redirect_uri</code>). Optionally, specify if you want the user to create a <a href=/resources/account-types/traditional-accounts.html>full Dwolla account</a> using the <code>verified_account</code> querystring parameter, and whether you want to initially present either the create an account or login screen using the <code>dwolla_landing</code> parameter.</p><h4>Request format</h4><div class="code-snippet js-code-snippet language-nohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-nohide data-lang=nohide>Production:
https://www.dwolla.com/oauth/v2/authenticate?client_id={client_id}&amp;response_type=code&amp;redirect_uri={redirect_uri}&amp;scope={scope}

UAT(Sandox):
https://uat.dwolla.com/oauth/v2/authenticate?client_id={client_id}&amp;response_type=code&amp;redirect_uri={redirect_uri}&amp;scope={scope}
</code></pre></div></div><blockquote><p>Remember to <a href=http://en.wikipedia.org/wiki/Percent-encoding>url-encode</a> all GET querystring parameters!</p></blockquote><h5>Request parameters</h5><table><thead><tr><th>Parameter</th><th>Required</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>client_id</td><td>yes</td><td>string</td><td>Application key.</td></tr><tr><td>response_type</td><td>yes</td><td>string</td><td>This must always be set to <code>code</code>.</td></tr><tr><td>redirect_uri</td><td>yes</td><td>string</td><td>URL where the user will be redirected to afterwards. The value of this parameter must match one of the values that appear in your <a href=https://www.dwolla.com/applications>application details</a> page. (We compare: protocol, subdomain, domain, tld, and file path. Querystring parameters are ignored)</td></tr><tr><td>scope</td><td>yes</td><td>string</td><td>Permissions you are requesting. See <a href=#oauth-scopes>below</a> for list of available scopes. Scopes are delimited by a pipe (&ldquo;&#124;&rdquo;)</td></tr><tr><td>state</td><td>no</td><td>string</td><td>Primary purpose is protection against cross-site request forgery (CSRF) attacks. A random value set by the client (you) in the initial OAuth authorization request, and is then made available to you in the redirect (along with the authorization <code>code</code>).</td></tr><tr><td>verified_account</td><td>no</td><td>string</td><td>Require new users opting to register for Dwolla to create a fully-verified Dwolla account instead of a default lightweight Direct account.</td></tr><tr><td>dwolla_landing</td><td>no</td><td>string</td><td>An optional override that force displays either the login or create an account screen. Possible values are: <code>login</code>, <code>register</code>, or <code>null</code>.</td></tr></tbody></table><h4>Example request</h4><div class="code-snippet js-code-snippet language-nohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-nohide data-lang=nohide>https://uat.dwolla.com/oauth/v2/authenticate?client_id=JCGQXLrlfuOqdUYdTcLz3rBiCZQDRvdWIUPkwssGMuGhkem9Bo&amp;response_type=code&amp;redirect_uri=https%3A%2F%2Fwww.myapplication.com%2Fredirect&amp;scope=send%7Ctransactions&amp;dwolla_landing=login&amp;state=6f102687b52e4f09b5f3a1c2966f2f41
</code></pre></div></div><h3>Request user authorization errors</h3><p>There are a few different errors that can occur in the initial OAuth authorization request that you will want to be prepared to handle. These errors will return a user facing message when they are redirected to Dwolla, notifying them that the application has an &ldquo;Invalid client configuration&rdquo;.</p><p><img src=/images/oauth/invalid-oauth-config.6436.png alt="Screenshot of Invalid OAuth config" title="Invalid OAuth config"></p><p>Since this is a generic error, your app will want to check all values specified in the initial authorization request. When checking the values in your request, here are a few things to keep in mind:</p><ul><li>client id: Does the <code>client_id</code> belong to a valid application created in the environment you are calling?</li><li>code: Does the <code>response_type</code> parameter equal the string value <code>code</code>?</li><li>redirect uri: Does the <code>redirect_uri</code> value match the value set in the OAuth Redirect URL field in your application&rsquo;s settings?</li><li>scope: Are the scopes you are requesting enabled on your application?</li></ul><h2>Step 2: Handle the OAuth redirect</h2><p>Your <code>redirect_uri</code> specified in the request is used by Dwolla to handle both the approval of authorization, as well as if the user cancels out of the flow or denies authorization. If the user denies authorization an error will be returned as an <code>error</code> querystring parameter.</p><p><img src=/images/oauth-permissions-screen.a36f.png alt="Screenshot of permissions screen" title="OAuth permissions screen"></p><h4><strong>User grants authorization</strong></h4><p>If the user authorizes your application, Dwolla will take them back to the supplied <code>redirect_uri</code>, along with a temporary authorization <code>code</code> as a GET querystring parameter (and a state parameter, if one was specified in the initial authorization request). <strong>Note:</strong> This is not an access token, yet. You will need to exchange this authorization code for an actual account access token and refresh token pair in the next step.</p><p><em>Approval example:</em> <code>https://www.myapplication.com/redirect?code=votwMtogKbmFxolxp9stBBnBvJVy</code></p><h4><strong>User denies authorization</strong></h4><p>If the user selects “deny” on the permissions page, Dwolla will take them back to the supplied <code>redirect_uri</code>, along with an <code>error</code> and <code>error_description</code> querystring parameters.</p><p><em>Rejection example:</em> <code>https://www.myapplication.com/redirect?error=access_denied&amp;error_description=The+user+denied+the+request</code></p><h2>Step 3: Finish user authorization</h2><p>In the final step of the authorization code flow, you will exchange the code granted on step 2 for an OAuth access token and refresh token pair. In order to do so, you will need to make an HTTP request from your application server to the Dwolla authorization server. The temporary authorization code is a single-use code that should be exchanged within 60 seconds of being returned in the <code>code</code> querystring parameter.</p><h5>HTTP request</h5><p><code>POST https://www.dwolla.com/oauth/v2/token</code></p><p>Including the <code>Content-Type: application/x-www-form-urlencoded</code> header, the request is sent to the token endpoint with the following <code>form-encoded</code> parameters:</p><h5>Request parameters</h5><table><thead><tr><th>Parameter</th><th>Required</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>client_id</td><td>yes</td><td>string</td><td>Application key.</td></tr><tr><td>client_secret</td><td>yes</td><td>string</td><td>Application secret.</td></tr><tr><td>code</td><td>yes</td><td>string</td><td>The authorization code included in the redirect URL. Single use <code>code</code> with an expiration of 60 seconds.</td></tr><tr><td>grant_type</td><td>yes</td><td>string</td><td>This must be set to <code>authorization_code</code>.</td></tr><tr><td>redirect_uri</td><td>yes</td><td>string</td><td>The same redirect_uri specified in the initiation step.</td></tr></tbody></table><h4>Example request</h4><div class="code-snippet js-code-snippet language-nohide"><button class="btn alternative">copy</button><div class="code-snippet__cnt highlight"><pre><code class=language-nohide data-lang=nohide>POST https://uat.dwolla.com/oauth/v2/token
Content-Type: application/x-www-form-urlencoded

client_id=CGQXLrlfuOqdUYdTcLz3rBiCZQDRvdWIUPkwasGMuGhkem9Bo&amp;client_secret=g7QLwvO37aN2HoKx1amekWi8a2g7AIuPbD5CcJSLqXIcDOxfTr&amp;code=h6TvQZHr5BsVcfO43uOJ0uRkBLki&amp;grant_type=authorization_code&amp;redirect_uri=https%3A%2F%2Fwww.myapplication.com%2Fredirect
</code></pre></div></div><h3>Example OAuth flow</h3><p>Our <a href=https://github.com/Dwolla/dwolla-v2-ruby>Ruby</a>, <a href=https://github.com/Dwolla/dwolla-v2-python>Python</a>, and <a href=https://github.com/Dwolla/dwolla-v2-node>Node.js</a> SDKs contain support for integrating the authorization code flow into your application, which is used to obtain an account access token. For languages where Dwolla does not have a supported SDK (e.g. PHP), we recommend using an external REST client. The following example shows a complete reference example of implementing the authorization code flow into your application.</p><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>not applicable
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>dwollav2</span>

<span class=c># you can find your consumer key and secret at dwolla.com/applications</span>
<span class=n>consumer_key</span> <span class=o>=</span> <span class=s>'...'</span>
<span class=n>consumer_secret</span> <span class=o>=</span> <span class=s>'...'</span>
<span class=n>client</span> <span class=o>=</span> <span class=n>dwollav2</span><span class=o>.</span><span class=n>Client</span><span class=p>(</span><span class=nb>id</span> <span class=o>=</span> <span class=n>consumer_key</span><span class=p>,</span>
                         <span class=n>secret</span> <span class=o>=</span> <span class=n>consumer_secret</span><span class=p>,</span>
                         <span class=n>environment</span> <span class=o>=</span> <span class=s>'sandbox'</span><span class=p>)</span> <span class=c># optional - defaults to production</span>

<span class=n>state</span> <span class=o>=</span> <span class=n>binascii</span><span class=o>.</span><span class=n>b2a_hex</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>15</span><span class=p>))</span>
<span class=n>client</span><span class=o>.</span><span class=n>Auth</span><span class=p>(</span><span class=n>redirect_uri</span> <span class=o>=</span> <span class=s>'https://yoursite.com/callback'</span><span class=p>,</span>
            <span class=n>scope</span> <span class=o>=</span> <span class=s>'ManageCustomers|Funding'</span><span class=p>,</span>
            <span class=n>state</span> <span class=o>=</span> <span class=n>state</span><span class=p>)</span>

<span class=c># redirect the user to dwolla.com for authorization</span>
<span class=n>redirect_to</span><span class=p>(</span><span class=n>auth</span><span class=o>.</span><span class=n>url</span><span class=p>)</span>

<span class=c># exchange the code for a token using the query params provided to the redirect_uri</span>
<span class=n>token</span> <span class=o>=</span> <span class=n>auth</span><span class=o>.</span><span class=n>callback</span><span class=p>(</span><span class=n>req</span><span class=o>.</span><span class=n>GET</span><span class=p>)</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript><span class=c1>// where to send the user after they grant permission:</span>
<span class=kd>var</span> <span class=nx>redirect_uri</span> <span class=o>=</span> <span class=s2>"https://www.myredirect.com/redirect"</span><span class=p>;</span>  

<span class=kd>var</span> <span class=nx>auth</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>client</span><span class=p>.</span><span class=nx>Auth</span><span class=p>({</span>
  <span class=na>redirect_uri</span><span class=p>:</span> <span class=s1>'http://yoursite.com/callback'</span><span class=p>,</span>
  <span class=na>scope</span><span class=p>:</span> <span class=s1>'ManageCustomers'</span><span class=p>,</span>
  <span class=na>state</span><span class=p>:</span> <span class=nx>getRandomHex</span><span class=p>(),</span> <span class=c1>// optional - https://tools.ietf.org/html/rfc6749#section-10.12</span>
  <span class=na>verified_account</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span> <span class=c1>// optional</span>
  <span class=na>dwolla_landing</span><span class=p>:</span> <span class=s1>'register'</span><span class=p>,</span> <span class=c1>// optional</span>
<span class=p>});</span>

<span class=c1>// redirect to `auth.url`</span>

<span class=nx>auth</span><span class=p>.</span><span class=nx>callback</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>query</span><span class=p>)</span> <span class=c1>// pass the code and optional state to the callback</span>
  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>token</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>'/'</span><span class=p>);</span>
  <span class=p>})</span>
  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>));</span>
  <span class=p>});</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby><span class=c1># config/initializers/dwolla.rb</span>
<span class=nb>require</span> <span class=s1>'dwolla_v2'</span>

<span class=c1># see dwolla.com/applications or uat.dwolla.com/applications (sandbox) for your consumer key and secret</span>
<span class=n>consumer_key</span> <span class=o>=</span> <span class=s2>"..."</span>
<span class=n>consumer_secret</span> <span class=o>=</span> <span class=s2>"..."</span>
<span class=vg>$dwolla</span> <span class=o>=</span> <span class=no>DwollaV2</span><span class=o>::</span><span class=no>Client</span><span class=p>.</span><span class=nf>new</span><span class=p>(</span><span class=ss>id: </span><span class=n>consumer_key</span><span class=p>,</span> <span class=ss>secret: </span><span class=n>consumer_secret</span><span class=p>)</span> <span class=k>do</span> <span class=o>|</span><span class=n>config</span><span class=o>|</span>
  <span class=n>config</span><span class=p>.</span><span class=nf>environment</span> <span class=o>=</span> <span class=ss>:sandbox</span> <span class=c1># optional - defaults to production</span>
<span class=k>end</span>

<span class=c1># app/controllers/your_auth_controller.rb</span>
<span class=k>class</span> <span class=nc>YourAuthController</span>
  <span class=c1># redirect the user to dwolla.com/oauth/v2/authenticate</span>
  <span class=k>def</span> <span class=nf>authenticate</span>
    <span class=n>redirect_to</span> <span class=n>auth</span><span class=p>.</span><span class=nf>url</span>
  <span class=k>end</span>

  <span class=c1># exchange the code for a token</span>
  <span class=k>def</span> <span class=nf>callback</span>
    <span class=n>account_token</span> <span class=o>=</span> <span class=n>auth</span><span class=p>.</span><span class=nf>callback</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
  <span class=k>end</span>

  <span class=kp>private</span>

  <span class=k>def</span> <span class=nf>auth</span>
    <span class=vg>$dwolla</span><span class=p>.</span><span class=nf>auths</span><span class=p>.</span><span class=nf>new</span> <span class=ss>redirect_uri: </span><span class=s2>"https://www.myredirect.com/redirect"</span><span class=p>,</span>
                      <span class=ss>scope: </span><span class=s2>"send|funding"</span><span class=p>,</span>
                      <span class=ss>state: </span><span class=n>session</span><span class=p>[</span><span class=ss>:state</span><span class=p>]</span> <span class=o>||=</span> <span class=no>SecureRandom</span><span class=p>.</span><span class=nf>hex</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php>/**
 *  No example for this language yet.
 **/
</code></pre></div></div><hr><h2>Refreshing an account access token</h2><p>Because access tokens are short-lived and expire 1 hour after being issued, if you wish to maintain authorization for a user account for a duration of time longer than 1 hour, you can use the refresh token to generate a new access token and refresh token. There is no limit to the number of times you can refresh a user&rsquo;s access token. Nonetheless, it is important to keep in mind that upon a successful refresh your existing access token will be invalidated.</p><p><strong>Note:</strong> We recommend safely storing a user&rsquo;s refresh token, i.e. in a database, so you can use it in the future to <a href=https://docsv2.dwolla.com/#refresh-authorization>refresh authorization</a>. If you misplace or delete a refresh token, then you will need to repeat the OAuth flow starting from the first step described above.</p><h5>HTTP request</h5><p><code>POST https://www.dwolla.com/oauth/v2/token</code></p><p>Including the <code>Content-Type: application/x-www-form-urlencoded</code> header, the request is sent to the token endpoint with the following <code>form-encoded</code> parameters:</p><h5>Request parameters</h5><table><thead><tr><th>Parameter</th><th>Required</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>client_id</td><td>yes</td><td>string</td><td>Application key.</td></tr><tr><td>client_secret</td><td>yes</td><td>string</td><td>Application secret.</td></tr><tr><td>refresh_token</td><td>yes</td><td>string</td><td>A valid refresh token.</td></tr><tr><td>grant_type</td><td>yes</td><td>string</td><td>This must be set to <code>refresh_token</code>.</td></tr></tbody></table><h4>Example request</h4><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>POST https://uat.dwolla.com/oauth/v2/token
Content-Type: application/x-www-form-urlencoded

client_id=CGQXLrlfuOqdUYdTcLz3rBiCZQDRvdWIUPkwasGMuGhkem9Bo&amp;client_secret=g7QLwvO37aN2HoKx1amekWi8a2g7AIuPbD5CcJSLqXIcDOxfTr&amp;grant_type=refresh_token&amp;refresh_token=Pgkel9okjwTCfsvIvEDPrsomE1er1txeyoaAkTIBAuXza8WvZY
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python><span class=c># Using dwollav2 - https://github.com/Dwolla/dwolla-v2-python</span>
<span class=c># Takes a Token as its first argument and returns a new token set.</span>
<span class=n>new_tokens</span> <span class=o>=</span> <span class=n>client</span><span class=o>.</span><span class=n>Auth</span><span class=o>.</span><span class=n>refresh</span><span class=p>(</span><span class=n>expired_token</span><span class=p>)</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript><span class=c1>// Using DwollaV2 - https://github.com/Dwolla/dwolla-v2-node</span>
<span class=kd>var</span> <span class=nx>oldToken</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>client</span><span class=p>.</span><span class=nx>Token</span><span class=p>({</span> <span class=na>refresh_token</span><span class=p>:</span> <span class=s1>'sHzEauv7FVpga2BSHVecKqFmCUfuhbBa4JRuClFuYa5vUSUdhL'</span> <span class=p>});</span>
<span class=nx>client</span><span class=p>.</span><span class=nx>auth</span><span class=p>.</span><span class=nx>refresh</span><span class=p>(</span><span class=nx>oldToken</span><span class=p>)</span>
  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>token</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>token</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>'/'</span><span class=p>);</span>
  <span class=p>})</span>
  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>));</span>
  <span class=p>});</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby><span class=c1># Using DwollaV2 - https://github.com/Dwolla/dwolla-v2-ruby</span>
<span class=c1># Takes a Token as its first argument and returns a new token set.</span>
<span class=n>new_tokens</span> <span class=o>=</span> <span class=vg>$dwolla</span><span class=p>.</span><span class=nf>auths</span><span class=p>.</span><span class=nf>refresh</span><span class=p>(</span><span class=n>expired_token</span><span class=p>)</span>
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php>/**
 *  No example for this language yet.
 **/
</code></pre></div></div><p>That&rsquo;s it! You&rsquo;re ready to start <a href=/guides/auth/using-an-access-token.html>making requests</a> to the <a href="https://docsv2.dwolla.com/">Dwolla API</a> on behalf of a user.</p><nav class=pager-nav><a href="./">Back: Overview</a> <a href=using-an-access-token.html>Next step: Using an access token</a></nav><hr><footer><div class=page-wrap><nav><h6>Product</h6><a href=https://www.dwolla.com/access-api>Access API</a></nav><nav><h6>Features</h6><a href=https://www.dwolla.com/bank-transfers>Bank Transfers</a> <a href=https://www.dwolla.com/mass-payments-api>Mass Payments</a> <a href=https://www.dwolla.com/same-day-ach>Same Day ACH</a> <a href=https://www.dwolla.com/white-label>White Label</a> <a href=https://www.dwolla.com/ach-transfer-dashboard>Dashboard & Admin</a> <a href=https://www.dwolla.com/dwollajs-bank-verification>Instant Bank Account Verification</a></nav><nav><h6>Account</h6><a href=https://accounts.dwolla.com/interest>Sign up</a> <a href=https://www.dwolla.com/login>Log in</a> <a href=http://help.dwolla.com>Support</a> <a href=https://www.dwolla.com/security>Security</a> <a href="https://www.dwolla.com/legal/privacy/">Privacy</a> <a href="https://www.dwolla.com/legal/tos/">Legal</a></nav><nav><h6>Case Studies</h6><a href="https://www.dwolla.com/updates/case-study-delivery-platform-leverages-dwolla-ach-api-for-payouts/">On-Demand Payouts</a> <a href="https://www.dwolla.com/updates/case-study-instagram-ad-platform-leverages-dwolla-api-for-payouts/">Ad Platform</a> <a href="https://www.dwolla.com/updates/dwolla-case-study-featuring-goat-for-ach-payouts/">Marketplace Payouts</a> <a href="https://www.dwolla.com/updates/kill-bill-adds-dwolla-to-offer-subscription-billing-with-ach-payments/">Subscription Billing</a> <a href="https://www.dwolla.com/updates/case-study-how-a-leading-rental-management-platform-used-an-ach-api/">Rental Collection</a> <a href="https://www.dwolla.com/updates/case-study-how-sweep-uses-dwolla-ach-api-for-bank-transfers/">Savings Tool</a> <a href="https://www.dwolla.com/updates/solar-investing-platform-uses-dwolla-api-to-power-bank-transfers/">Investment Platform</a> <a href="https://www.dwolla.com/updates/case-study-clear-capital-streamlines-disbursements-with-dwolla/">B2B Disbursements</a></nav><nav><h6>Learn more</h6><a href=https://www.dwolla.com/contact>Let's talk</a> <a href=https://developers.dwolla.com>Developer Docs</a> <a href=https://www.dwolla.com/updates>Updates</a> <a href=https://www.dwolla.com/press>Press</a> <a href=https://www.dwolla.com/careers>Careers</a></nav></div></footer><section class=disclaimer><div class=page-wrap><h5>Financial institutions play an important role in the Dwolla network.</h5><p>Dwolla, Inc. is an agent of Veridian Credit Union and Compass Bank and all funds associated with your account in the Dwolla network are held in pooled accounts at Veridian Credit Union and Compass Bank. These funds are not eligible for individual insurance, including FDIC insurance and may not be eligible for share insurance by the National Credit Union Share Insurance Fund. Dwolla, Inc. is the operator of a software platform that communicates user instructions for funds transfers to Veridian Credit Union and Compass Bank.</p></div></section><section class=copyright><div class=page-wrap><div><span>© 2016 Dwolla, Inc.</span> <a href="https://www.dwolla.com/legal/about-our-financial-institution-partner/">Dwolla, Inc. is an agent of its Financial Institution Partner(s)</a></div></div></section></section></div></div></div><script src=//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script>window.jQuery || document.write('<script src="/_bower_components/jquery/jquery.min.js"><\/script>')</script><script src=/js/script.3a68.js></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
  function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
  e=o.createElement(i);r=o.getElementsByTagName(i)[0];
  e.src='//www.google-analytics.com/analytics.js';
  r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
  ga('create','UA-30404064-1');ga('send','pageview');</script></body></html>