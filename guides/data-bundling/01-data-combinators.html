<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Data Combinators | Hub of All Things API</title><meta name=description content="Complex HAT Data transformations"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/css/main.fa80.css><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel=stylesheet><link rel=stylesheet href="//fonts.googleapis.com/css?family=Roboto+Slab:300|Open+Sans:300,400,600,700"><script src=/js/head-scripts.e78f.js></script><script src=https://cdn.statuspage.io/se-v2.js></script><!-- Code highlighting --><link rel=stylesheet href=/lib/code-highlight/styles/atom-one-dark.css><script src=/lib/code-highlight/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></head><body><!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><header><div class="header__primary js-two-col-header-primary"><div class=page-wrap><div><a href="/" class="logo icon-logo-hat-white">Hub of All Things</a><div class=hamburger><a href=http://hubofallthings.com/c/about>What is the HAT</a> <a class="btn primary js-hamburger">Menu</a></div></div><nav class=js-hamburger-nav><a href="/">Developers</a> <a href="https://www.hatdex.org/">Data Exchange</a> <a href="https://hatcommunity.org/">Community Foundation</a> <a class="btn primary" href="https://hubofallthings.com/">Hub of All Things</a></nav></div></div><nav class="header__secondary js-two-col-nav-toggle"><div class=js-two-col-header-secondary><div class=page-wrap><a href="/home/">Resources</a> <a href="/guides/" class=active>Guides</a><!-- <a href="/documentation/" >API docs</a> --><!-- <a href="/tutorials/" >Tutorials</a> --> <a href=https://github.com/Hub-of-all-Things class="no-nav js-two-col-no-toggle">Repositories</a><div class="custom-select custom-select--blue js-global-language-select"><select name=select class=js-language-select><option value=raw>raw</option><option value=php>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div></div></nav></header><div class=content><div class=cnt-two-col><div class=page-wrap><section class="cnt-two-col__nav js-two-col-nav"><div class=close><button class="js-two-col-nav-close icon-cnt-two-col-close"></button></div><div class=language-picker><h6>Language</h6><div class="custom-select custom-select--blue"><select class=js-language-select name=select><option value=raw>raw</option><option value=php selected>php</option><option value=ruby>ruby</option><option value=python>python</option><option value=javascript>javascript</option></select><div class=arrow></div></div></div><!-- nav elements below should be in the same order of the secondary navigation --><nav class="side-nav js-side-nav"><section><h6>Tools</h6><ul><li><a href=/home/tools/HAT_core.html>HAT</a><ul></ul></li><li><a href=/home/tools/rumpel.html>Rumpel</a><ul></ul></li><li><a href=/home/tools/rumpellite.html>RumpelLite</a><ul></ul></li><li><a href=/home/tools/milliner.html>Milliner</a><ul></ul></li><li><a href=/home/tools/data_plugs.html>Data Plugs</a><ul></ul></li><li><a href=/home/tools/dex.html>DEX</a><ul></ul></li><li><a href=/home/tools/marketsquare.html>MarketSquare</a><ul></ul></li><li><a href=/home/tools/databuyer.html>Data Buyer</a><ul></ul></li><li><a href=/home/tools/off_the_shelf_hats.html>Off-the-shelf HATs</a><ul></ul></li></ul><h6>HAT Certification</h6><ul><li><a href=/home/hat_applications.html>HAT Applications</a><ul><li><a href=/home/hat_applications/rating_scheme_best_practice.html>Rating Scheme Best Practice</a></li><li><a href=/home/hat_applications/rating_scheme.html>Rating Scheme</a></li></ul></li><li><a href=/home/hat_service_provider.html>HAT Service Provider</a><ul><li><a href=/home/hat_service_provider/security_requirement_best_practice.html>Security Requirement Best Practice</a></li><li><a href=/home/hat_service_provider/security_requirement.html>Security Requirement</a></li></ul></li></ul><h6>Knowing the HAT Tech Ecosystem</h6><ul><li><a href=/home/knowing.html>Knowing the Ecosystem</a><ul><li><a href=/home/knowing/2_hat_users.html>HAT Users</a></li><li><a href=/home/knowing/3_hat_application.html>HAT Applications</a></li><li><a href=/home/knowing/4_hat_community_foundation.html>HAT Community Foundation</a></li><li><a href=/home/knowing/5_hatdex.html>HATDeX</a></li></ul></li><li><a href=/home/knowing/hat_platform_process_architecture.html>The Architecture Diagram</a><ul></ul></li></ul><h6>Why the HAT?</h6><ul><li><a href=/home/why/what_is_hat.html>Why the HAT?</a><ul></ul></li><li><a href=/home/why/what_can_you_make.html>What can you make on the HAT?</a><ul></ul></li><li><a href=/home/why/why_build_something_on_the_hat.html>Why build something on the HAT?</a><ul></ul></li><li><a href=/home/why/some_cool_apps.html>Some cool apps</a><ul></ul></li></ul></section><section class=side-nav__options><h6>Other Resources</h6><ul><li class=external-link><a href=https://hatters.hubofallthings.com target=_blank><span class=icon-sidenav-option>Get a HAT</span></a></li><li class=external-link><a href=http://forum.hatcommunity.org/c/developers target=_blank><span class=icon-sidenav-option>Developer Forum</span></a></li></ul></section></nav><nav class="side-nav js-side-nav"><section><h6>API v2</h6><ul><li><a href=/documentation/authentication-v2.html>Authentication</a><ul></ul></li><li><a href=/documentation/bundles-v2.html>Bundles</a><ul><li><a href=/documentation/bundles-v2/retrieve_registered_bundle_data.html>Retrieve Registered Bundle Data</a></li><li><a href=/documentation/bundles-v2/propose_data_bundles.html>Propose Data Bundles</a></li></ul></li><li><a href=/documentation/combinators-v2.html>Combinators</a><ul><li><a href=/documentation/combinators-v2/get_data.html>Propose Data Bundles</a></li><li><a href=/documentation/combinators-v2/propose_endpoint.html>Propose A New data Endpoint</a></li></ul></li><li><a href=/documentation/data-v2.html>Data</a><ul><li><a href=/documentation/data-v2/bulk_upload.html>Bulk-upload a large chunk of data to the same endpoint</a></li><li><a href=/documentation/data-v2/delete_a_record.html>Delete A Record</a></li><li><a href=/documentation/data-v2/filter_data_records.html>Filter data records up to a maximum number</a></li><li><a href=/documentation/data-v2/get_data_records.html>Data Records</a></li></ul></li><li><a href=/documentation/data_debits-v2.html>Data Debits</a><ul><li><a href=/documentation/data_debits-v2/update_a_data_debit.html>Update a data debit</a></li><li><a href=/documentation/data_debits-v2/disable_a_data_debit_copy.html>Disable a Data Debit</a></li><li><a href=/documentation/data_debits-v2/enable_a_data_debit.html>Enable a Data Debit</a></li><li><a href=/documentation/data_debits-v2/get_data_debit_values.html>Get Data Debit values</a></li><li><a href=/documentation/data_debits-v2/propose_a_data_debit.html>Propose a Data Debit</a></li></ul></li><li><a href=/documentation/file_storage-v2.html>HAT File Storage</a><ul></ul></li><li><a href=/documentation/linked_data-v2.html>Linked Data</a><ul><li><a href=/documentation/linked_data-v2/new_endpoint.html>New endpoint for linked data retrieval</a></li><li><a href=/documentation/linked_data-v2/batch_data_upload.html>Batch data upload</a></li><li><a href=/documentation/linked_data-v2/save_an_example_record.html>Save an example notable record</a></li><li><a href=/documentation/linked_data-v2/save_an_example_nudge.html>Save an example nudge</a></li><li><a href=/documentation/linked_data-v2/retireve_linked_data.html>Retrieve linked data points as per registered endpoint</a></li><li><a href=/documentation/linked_data-v2/link_up_data_records.html>Link up data records</a></li></ul></li></ul><h6>API v1 - Deprecated</h6><ul><li><a href=/documentation/raw_data_input_and_output.html>Raw Data Input and Output</a><ul><li><a href=/documentation/raw_data_input_and_output/data_field.html>Data Field</a></li><li><a href=/documentation/raw_data_input_and_output/data_sources.html>Data Sources</a></li><li><a href=/documentation/raw_data_input_and_output/data_tables.html>Data Tables</a></li><li><a href=/documentation/raw_data_input_and_output/data_value.html>Data Value</a></li><li><a href=/documentation/raw_data_input_and_output/retrieving_raw_data.html>Retrieving Raw Data</a></li></ul></li><li><a href=/documentation/sharing_and_direct_data_debits.html>Sharing and Direct Data Debits</a><ul></ul></li><li><a href=/documentation/user_management.html>User Management</a><ul><li><a href=/documentation/user_management/authentication.html>Authentication</a></li><li><a href=/documentation/user_management/direct_data_credit_and_debit_accounts.html>Direct Data Credit and Debit Accounts</a></li></ul></li></ul></section></nav><nav class="side-nav js-side-nav active"><section id=js-sidenav-dropdown class=side-nav__dropdown><h6>Choose a guide</h6><div class=picker id=js-sidenav-dropdown-button><button>The power of HAT data bundling</button><div class="icon icon-side-nav-collapse-plus"></div><div class="icon icon-side-nav-collapse-minus"></div></div><nav id=js-sidenav-dropdown-nav><a href=/guides/hat_login>HAT Login</a> <a href=/guides/raw_data_io>Raw Data I/O</a> <a href=/guides/data-bundling>The power of HAT data bundling</a> <a href=/guides/data-debits>Data Debits for consented data sharing</a> <a href=/guides/dex>Data Exchange Services</a> <a href=/guides/file-storage>File Storage</a> <a href=/guides/provisioning>Provisioning</a> <a href=/guides/building-data-plug>Building a Data Plug</a> <a href=/guides/requesting-data-databuyer>Requesting Data from HAT users</a> <a href=/guides/customising-rumpel>Customising Rumpel</a></nav></section><section class=steps-nav><h6>In this guide</h6><ol><li><a href=/guides/data-bundling>Overview: The power of HAT data bundling</a><div class=dot></div></li><li><a href=/guides/data-bundling/01-data-combinators.html class=active>Data Combinators</a><div class=dot></div></li><li><a href=/guides/data-bundling/02-data-bundles.html>Data Bundles</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/data-debits>Overview: Data Debits for consented data sharing</a><div class=dot></div></li><li><a href=/guides/data-debits/01-data-debit-proposal.html>Data Debit Proposal</a><div class=dot></div></li><li><a href=/guides/data-debits/02-approve-data-debit.html>Approve Data Debit</a><div class=dot></div></li><li><a href=/guides/data-debits/03-request-data-debit-values.html>Request Data Debit Values</a><div class=dot></div></li><li><a href=/guides/data-debits/04-update-data-debit.html>Optional - Update Data Debit</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/raw_data_io>Overview: Raw Data I/O</a><div class=dot></div></li><li><a href=/guides/raw_data_io/01-data-input.html>Data Input</a><div class=dot></div></li><li><a href=/guides/raw_data_io/02-data-retrieval.html>Data Retrieval</a><div class=dot></div></li><li><a href=/guides/raw_data_io/03-data-modification.html>Data Modification</a><div class=dot></div></li><li><a href=/guides/raw_data_io/04-next-steps.html>Consented Data Exchange</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/hat_login>Overview: HAT Login</a><div class=dot></div></li><li><a href=/guides/hat_login/01-send-hat-login.html>Step 1 - Send user for HAT Login</a><div class=dot></div></li><li><a href=/guides/hat_login/02-login-ui.html>Step 2 - User Logs in</a><div class=dot></div></li><li><a href=/guides/hat_login/03-verify-authenticate.html>Step 3 - Verify and authenticate user</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/provisioning>Overview: Provisioning</a><div class=dot></div></li><li><a href=/guides/provisioning/01-sign-up.html>Step 1 - Sign user up with Milliner</a><div class=dot></div></li><li><a href=/guides/provisioning/02-create-hat.html>Step 2 - Create the HAT</a><div class=dot></div></li><li><a href=/guides/provisioning/03-register-hat.html>Step 3 - Register HAT with DEX</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/dex>Overview: Data Exchange Services</a><div class=dot></div></li><li><a href=/guides/dex/01-statistics.html>DEX Statistics</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/file-storage>Overview: File Storage</a><div class=dot></div></li><li><a href=/guides/file-storage/01-upload.html>Step 1 - File Upload</a><div class=dot></div></li><li><a href=/guides/file-storage/02-access-management.html>Step 2 - Access Management</a><div class=dot></div></li><li><a href=/guides/file-storage/03-contents.html>Step 3 - Content Access</a><div class=dot></div></li><li><a href=/guides/file-storage/04-search.html>Step 4 - File lookup/search</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/customising-rumpel>Overview: Customising Rumpel</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/building-data-plug>Overview: Building a Data Plug</a><div class=dot></div></li></ol></section><section class=steps-nav style=display:none><h6>In this guide</h6><ol><li><a href=/guides/requesting-data-databuyer>Overview: Requesting Data from HAT users</a><div class=dot></div></li></ol></section><section class=side-nav__options><h6>API Resources</h6><ul><li class=external-link><a href=https://documenter.getpostman.com/view/110376/hat-rich-data-api-showcase/6YySZS7 target=_blank><span class=icon-sidenav-option>API v2 reference docs</span></a></li><li class=external-link><a href="http://hub-of-all-things.github.io/doc/" target=_blank><span class=icon-sidenav-option>API v1 reference docs</span></a></li></ul></section></nav></section><section class=cnt-two-col__content><p>The API supports a notion of custom data &ldquo;combinators&rdquo;, with the key feature being data transformation. It allows for: - remapping data JSON from such different streams into structures chosen by the developer to facilitate consistent structures across unrelated sources - combining data from multiple feeds into a single response stream - ordering of data according to underlying JSON structure fields - filtering of data according to underlying JSON values (including text-based search) - it is achieved by registering a datapoint with a data mapping specification and <code>GET</code>ing data from the registered endpoint</p><h3 id=remapping-json-structures>Remapping JSON structures</h3><p>One of the simplest types of data manipulation is remapping of data structure. This is done by creating a <em>combinator</em> with a <code>POST</code> request to <code>/api/v2/combinator/COMBINATOR_NAME</code> having chosen a name for your data combinator. Combinator name can be any valid URL path, but must be unique - request will fail with an error otherwise.</p><p>A simple example extracting two fields, <code>longitude</code> and <code>latitude</code> from a rumpel locations endpoint and unwrapping them to a top-level object:</p><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>curl --request POST \
  --url https://test.hubat.net/api/v2/combinator/locations \
  --header 'content-type: application/json' \
  --header 'x-auth-token: ACCESS_TOKEN' \
  --data '[{&quot;endpoint&quot;:&quot;rumpel/locations&quot;,&quot;mapping&quot;:{&quot;longitude&quot;:&quot;data.locations.longitude&quot;,&quot;latitude&quot;:&quot;data.locations.latitude&quot;}}]'
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript>var data = JSON.stringify([
  {
    &quot;endpoint&quot;: &quot;rumpel/locations&quot;,
    &quot;mapping&quot;: {
      &quot;longitude&quot;: &quot;data.locations.longitude&quot;,
      &quot;latitude&quot;: &quot;data.locations.latitude&quot;
    }
  }
]);

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener(&quot;readystatechange&quot;, function () {
  if (this.readyState === this.DONE) {
    console.log(this.responseText);
  }
});

xhr.open(&quot;POST&quot;, &quot;https://test.hubat.net/api/v2/combinator/locations&quot;);
xhr.setRequestHeader(&quot;content-type&quot;, &quot;application/json&quot;);
xhr.setRequestHeader(&quot;x-auth-token&quot;, &quot;ACCESS_TOKEN&quot;);

xhr.send(data);
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php>&lt;?php

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL =&gt; &quot;https://test.hubat.net/api/v2/combinator/locations&quot;,
  CURLOPT_RETURNTRANSFER =&gt; true,
  CURLOPT_ENCODING =&gt; &quot;&quot;,
  CURLOPT_MAXREDIRS =&gt; 10,
  CURLOPT_TIMEOUT =&gt; 30,
  CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST =&gt; &quot;POST&quot;,
  CURLOPT_POSTFIELDS =&gt; &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;data.locations.longitude\&quot;,\&quot;latitude\&quot;:\&quot;data.locations.latitude\&quot;}}]&quot;,
  CURLOPT_HTTPHEADER =&gt; array(
    &quot;content-type: application/json&quot;,
    &quot;x-auth-token: ACCESS_TOKEN&quot;
  ),
));

$response = curl_exec($curl);
$err = curl_error($curl);

curl_close($curl);

if ($err) {
  echo &quot;cURL Error #:&quot; . $err;
} else {
  echo $response;
}
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python>import requests

url = &quot;https://test.hubat.net/api/v2/combinator/locations&quot;

payload = &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;data.locations.longitude\&quot;,\&quot;latitude\&quot;:\&quot;data.locations.latitude\&quot;}}]&quot;
headers = {
    'content-type': &quot;application/json&quot;,
    'x-auth-token': &quot;ACCESS_TOKEN&quot;
    }

response = requests.request(&quot;POST&quot;, url, data=payload, headers=headers)

print(response.text)
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby>require 'uri'
require 'net/http'

url = URI(&quot;https://test.hubat.net/api/v2/combinator/locations&quot;)

http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE

request = Net::HTTP::Post.new(url)
request[&quot;content-type&quot;] = 'application/json'
request[&quot;x-auth-token&quot;] = 'ACCESS_TOKEN'
request.body = &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;data.locations.longitude\&quot;,\&quot;latitude\&quot;:\&quot;data.locations.latitude\&quot;}}]&quot;

response = http.request(request)
puts response.read_body
</code></pre></div></div><p>The created combinator can be used by simply sending <code>GET</code> to <code>/api/v2/combinator/COMBINATOR_NAME</code> endpoint:</p><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>curl --request GET \
  --url 'https://test.hubat.net/api/v2/combinator/locations?take=5' \
  --header 'x-auth-token: ACCESS_TOKEN'
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript>var data = null;

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener(&quot;readystatechange&quot;, function () {
  if (this.readyState === this.DONE) {
    console.log(this.responseText);
  }
});

xhr.open(&quot;GET&quot;, &quot;https://test.hubat.net/api/v2/combinator/locations?take=5&quot;);
xhr.setRequestHeader(&quot;x-auth-token&quot;, &quot;ACCESS_TOKEN&quot;);

xhr.send(data);
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php>&lt;?php

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL =&gt; &quot;https://test.hubat.net/api/v2/combinator/locations?take=5&quot;,
  CURLOPT_RETURNTRANSFER =&gt; true,
  CURLOPT_ENCODING =&gt; &quot;&quot;,
  CURLOPT_MAXREDIRS =&gt; 10,
  CURLOPT_TIMEOUT =&gt; 30,
  CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST =&gt; &quot;GET&quot;,
  CURLOPT_HTTPHEADER =&gt; array(
    &quot;x-auth-token: ACCESS_TOKEN&quot;
  ),
));

$response = curl_exec($curl);
$err = curl_error($curl);

curl_close($curl);

if ($err) {
  echo &quot;cURL Error #:&quot; . $err;
} else {
  echo $response;
}
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python>import requests

url = &quot;https://test.hubat.net/api/v2/combinator/locations&quot;

headers = {'x-auth-token': 'ACCESS_TOKEN'}

response = requests.request(&quot;GET&quot;, url, headers=headers)

print(response.text)
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby>require 'uri'
require 'net/http'

url = URI(&quot;https://test.hubat.net/api/v2/combinator/locations?take=5&quot;)

http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE

request = Net::HTTP::Get.new(url)
request[&quot;x-auth-token&quot;] = 'ACCESS_TOKEN'

response = http.request(request)
puts response.read_body
</code></pre></div></div><p>It responds with the same data structure as plain data APIs: with a list of data records wrapped with the basic record details and the data itself remapped according to the registered combinator.</p><div class="code-snippet js-code-snippet language-http"><p></p><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch_ id=http>Remapped data example</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-http data-lang=http>
HTTP/1.1 200 OK
Content-Type: application/json


[
  {
    "endpoint": "rumpel/locations",
    "recordId": "e965e022-6613-476a-a0cd-1f587a41b148",
    "data": {
      "longitude": "0.101014673709963",
      "latitude": "51.671358277138"
    }
  },
  {
    "endpoint": "rumpel/locations",
    "recordId": "fcf1a26b-e49f-4457-915b-156e14140f38",
    "data": {
      "longitude": "0.100905202634514",
      "latitude": "51.674001392439"
    }
  },
  {
    "endpoint": "rumpel/locations",
    "recordId": "8f7afa92-39e2-48ab-8028-f5aebaa9918e",
    "data": {
      "longitude": "0.080477950927866",
      "latitude": "51.6658257133844"
    }
  },
  {
    "endpoint": "rumpel/locations",
    "recordId": "d3a6f04b-4df6-4888-a7b0-c1d5ca272de9",
    "data": {
      "longitude": "0.0641066288762133",
      "latitude": "51.6641215101037"
    }
  },
  {
    "endpoint": "rumpel/locations",
    "recordId": "6a858d87-899e-4961-b722-0738d07c755e",
    "data": {
      "longitude": "0.0961801595986785",
      "latitude": "51.6712232446779"
    }
  }
]
</code></pre></div></div><h3 id=combining-data-from-multiple-endpoints>Combining data from multiple endpoints</h3><p>Combinators are also very useful when you want to combine data from different endpoints using the same format. In this case, you define multiple entries in the list of endpoints:</p><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>curl --request POST \
  --url https://test.hubat.net/api/v2/combinator/locations \
  --header 'content-type: application/json' \
  --header 'x-auth-token: ACCESS_TOKEN' \
  --data '[{&quot;endpoint&quot;:&quot;rumpel/locations&quot;,&quot;mapping&quot;:{&quot;longitude&quot;:&quot;data.locations.longitude&quot;,&quot;latitude&quot;:&quot;data.locations.latitude&quot;}},{&quot;endpoint&quot;:&quot;ios/locations&quot;,&quot;mapping&quot;:{&quot;longitude&quot;:&quot;phoneLocation.longitude&quot;,&quot;latitude&quot;:&quot;phoneLocation.latitude&quot;}}]'
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript>var data = JSON.stringify([
  {
    &quot;endpoint&quot;: &quot;rumpel/locations&quot;,
    &quot;mapping&quot;: {
      &quot;longitude&quot;: &quot;data.locations.longitude&quot;,
      &quot;latitude&quot;: &quot;data.locations.latitude&quot;
    }
  },
  {
    &quot;endpoint&quot;: &quot;ios/locations&quot;,
    &quot;mapping&quot;: {
      &quot;longitude&quot;: &quot;phoneLocation.longitude&quot;,
      &quot;latitude&quot;: &quot;phoneLocation.latitude&quot;
    }
  }
]);

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener(&quot;readystatechange&quot;, function () {
  if (this.readyState === this.DONE) {
    console.log(this.responseText);
  }
});

xhr.open(&quot;POST&quot;, &quot;https://test.hubat.net/api/v2/combinator/locations&quot;);
xhr.setRequestHeader(&quot;content-type&quot;, &quot;application/json&quot;);
xhr.setRequestHeader(&quot;x-auth-token&quot;, &quot;ACCESS_TOKEN&quot;);

xhr.send(data);
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php>&lt;?php

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL =&gt; &quot;https://test.hubat.net/api/v2/combinator/locations&quot;,
  CURLOPT_RETURNTRANSFER =&gt; true,
  CURLOPT_ENCODING =&gt; &quot;&quot;,
  CURLOPT_MAXREDIRS =&gt; 10,
  CURLOPT_TIMEOUT =&gt; 30,
  CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST =&gt; &quot;POST&quot;,
  CURLOPT_POSTFIELDS =&gt; &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;data.locations.longitude\&quot;,\&quot;latitude\&quot;:\&quot;data.locations.latitude\&quot;}},{\&quot;endpoint\&quot;:\&quot;ios/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;phoneLocation.longitude\&quot;,\&quot;latitude\&quot;:\&quot;phoneLocation.latitude\&quot;}}]&quot;,
  CURLOPT_HTTPHEADER =&gt; array(
    &quot;content-type: application/json&quot;,
    &quot;x-auth-token: ACCESS_TOKEN&quot;
  ),
));

$response = curl_exec($curl);
$err = curl_error($curl);

curl_close($curl);

if ($err) {
  echo &quot;cURL Error #:&quot; . $err;
} else {
  echo $response;
}
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python>import requests

url = &quot;https://test.hubat.net/api/v2/combinator/locations&quot;

payload = &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;data.locations.longitude\&quot;,\&quot;latitude\&quot;:\&quot;data.locations.latitude\&quot;}},{\&quot;endpoint\&quot;:\&quot;ios/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;phoneLocation.longitude\&quot;,\&quot;latitude\&quot;:\&quot;phoneLocation.latitude\&quot;}}]&quot;
headers = {
    'content-type': &quot;application/json&quot;,
    'x-auth-token': &quot;ACCESS_TOKEN&quot;
    }

response = requests.request(&quot;POST&quot;, url, data=payload, headers=headers)

print(response.text)
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby>require 'uri'
require 'net/http'

url = URI(&quot;https://test.hubat.net/api/v2/combinator/locations&quot;)

http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE

request = Net::HTTP::Post.new(url)
request[&quot;content-type&quot;] = 'application/json'
request[&quot;x-auth-token&quot;] = 'ACCESS_TOKEN'
request.body = &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;data.locations.longitude\&quot;,\&quot;latitude\&quot;:\&quot;data.locations.latitude\&quot;}},{\&quot;endpoint\&quot;:\&quot;ios/locations\&quot;,\&quot;mapping\&quot;:{\&quot;longitude\&quot;:\&quot;phoneLocation.longitude\&quot;,\&quot;latitude\&quot;:\&quot;phoneLocation.latitude\&quot;}}]&quot;

response = http.request(request)
puts response.read_body
</code></pre></div></div><h3 id=fetching-linked-data>Fetching linked data</h3><p>The guide on <a href=../raw_data_io>raw data I/O</a> covered linked data entry, but did not explain how such data can be retrieved. This is also achieved using data <code>combinators</code>, by providing a list of <code>links</code> with <code>endpoints</code> from which linked data should be included. This way no unexpected data will be included when requesting data.</p><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>curl --request POST \
  --url https://test.hubat.net/api/v2/combinator/notables \
  --header 'content-type: application/json' \
  --header 'x-auth-token: ACCESS_TOKEN' \
  --data '[{&quot;endpoint&quot;:&quot;rumpel/notable&quot;,&quot;links&quot;:[{&quot;endpoint&quot;:&quot;rumpel/nudge&quot;}]}]'
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript>var data = JSON.stringify([
  {
    &quot;endpoint&quot;: &quot;rumpel/notable&quot;,
    &quot;links&quot;: [
      {
        &quot;endpoint&quot;: &quot;rumpel/nudge&quot;
      }
    ]
  }
]);

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener(&quot;readystatechange&quot;, function () {
  if (this.readyState === this.DONE) {
    console.log(this.responseText);
  }
});

xhr.open(&quot;POST&quot;, &quot;https://test.hubat.net/api/v2/combinator/notables&quot;);
xhr.setRequestHeader(&quot;content-type&quot;, &quot;application/json&quot;);
xhr.setRequestHeader(&quot;x-auth-token&quot;, &quot;ACCESS_TOKEN&quot;);

xhr.send(data);
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php>&lt;?php

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL =&gt; &quot;https://test.hubat.net/api/v2/combinator/notables&quot;,
  CURLOPT_RETURNTRANSFER =&gt; true,
  CURLOPT_ENCODING =&gt; &quot;&quot;,
  CURLOPT_MAXREDIRS =&gt; 10,
  CURLOPT_TIMEOUT =&gt; 30,
  CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST =&gt; &quot;POST&quot;,
  CURLOPT_POSTFIELDS =&gt; &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/notable\&quot;,\&quot;links\&quot;:[{\&quot;endpoint\&quot;:\&quot;rumpel/nudge\&quot;}]}]&quot;,
  CURLOPT_HTTPHEADER =&gt; array(
    &quot;content-type: application/json&quot;,
    &quot;x-auth-token: ACCESS_TOKEN&quot;
  ),
));

$response = curl_exec($curl);
$err = curl_error($curl);

curl_close($curl);

if ($err) {
  echo &quot;cURL Error #:&quot; . $err;
} else {
  echo $response;
}
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python>import requests

url = &quot;https://test.hubat.net/api/v2/combinator/notables&quot;

payload = &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/notable\&quot;,\&quot;links\&quot;:[{\&quot;endpoint\&quot;:\&quot;rumpel/nudge\&quot;}]}]&quot;
headers = {
    'content-type': &quot;application/json&quot;,
    'x-auth-token': &quot;ACCESS_TOKEN&quot;
    }

response = requests.request(&quot;POST&quot;, url, data=payload, headers=headers)

print(response.text)
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby>require 'uri'
require 'net/http'

url = URI(&quot;https://test.hubat.net/api/v2/combinator/notables&quot;)

http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE

request = Net::HTTP::Post.new(url)
request[&quot;content-type&quot;] = 'application/json'
request[&quot;x-auth-token&quot;] = 'ACCESS_TOKEN'
request.body = &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/notable\&quot;,\&quot;links\&quot;:[{\&quot;endpoint\&quot;:\&quot;rumpel/nudge\&quot;}]}]&quot;

response = http.request(request)
puts response.read_body
</code></pre></div></div><p>A response to fetch data from this combinator results in something like:</p><div class="code-snippet js-code-snippet language-http"><p></p><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch_ id=http>Sample Linked Records</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-http data-lang=http>
HTTP/1.1 200 OK
Content-Type: application/json


[
  {
    "endpoint": "rumpel/notable",
    "recordId": "5a2547ec-63cc-47c7-938d-f4c1e2cad930",
    "data": {
      "id": 84995,
      "data": {
        "notablesv1": {
          "kind": "note",
          "shared": "true",
          "message": "Showcasing the new HAT APIs",
          "authorv1": {
            "phata": "testing.hubat.net"
          },
          "shared_on": "twitter",
          "created_time": "2017-04-10T14:19:59:+01:00",
          "public_until": "2017-05-11T14:21:54+01:00",
          "updated_time": "2017-04-23T14:21:58+01:00"
        }
      },
      "lastUpdated": "2017-04-23T14:21:51+01:00"
    },
    "links": [
      {
        "endpoint": "rumpel/nudge",
        "recordId": "db3868d4-d042-45b4-af12-744f81d6d631",
        "data": {
          "time": "2017-04-30T14:22:52+01:00",
          "type": "time",
          "nudge": "Share APIs with the world"
        }
      }
    ]
  }
]
</code></pre></div></div><h3 id=data-filtering>Data Filtering</h3><p>The combinators API allows for powerful filtering of data according to the recorded values. The combinator gets created by <code>POST</code>ing a request to <code>/api/v2/combinator/COMBINATOR_NAME</code> as previously, however for each source of data you may also define one or more <code>filters</code> in addition to the <code>endpoint</code> and <code>transformation</code> used to remap the data:</p><div class="code-snippet js-code-snippet language-raw"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-raw data-lang=raw>curl --request POST \
  --url https://test.hubat.net/api/v2/combinator/locations/morningcommute \
  --header 'content-type: application/json' \
  --header 'x-auth-token: ACCESS_TOKEN' \
  --data '[{&quot;endpoint&quot;:&quot;rumpel/locations&quot;,&quot;filters&quot;:[{&quot;field&quot;:&quot;data.locations.timestamp&quot;,&quot;transformation&quot;:{&quot;transformation&quot;:&quot;datetimeExtract&quot;,&quot;part&quot;:&quot;hour&quot;},&quot;operator&quot;:{&quot;operator&quot;:&quot;between&quot;,&quot;lower&quot;:7,&quot;upper&quot;:9}}]}]'
</code></pre></div></div><div class="code-snippet js-code-snippet language-javascript"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-javascript data-lang=javascript>var data = JSON.stringify([
  {
    &quot;endpoint&quot;: &quot;rumpel/locations&quot;,
    &quot;filters&quot;: [
      {
        &quot;field&quot;: &quot;data.locations.timestamp&quot;,
        &quot;transformation&quot;: {
          &quot;transformation&quot;: &quot;datetimeExtract&quot;,
          &quot;part&quot;: &quot;hour&quot;
        },
        &quot;operator&quot;: {
          &quot;operator&quot;: &quot;between&quot;,
          &quot;lower&quot;: 7,
          &quot;upper&quot;: 9
        }
      }
    ]
  }
]);

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener(&quot;readystatechange&quot;, function () {
  if (this.readyState === this.DONE) {
    console.log(this.responseText);
  }
});

xhr.open(&quot;POST&quot;, &quot;https://test.hubat.net/api/v2/combinator/locations/morningcommute&quot;);
xhr.setRequestHeader(&quot;content-type&quot;, &quot;application/json&quot;);
xhr.setRequestHeader(&quot;x-auth-token&quot;, &quot;ACCESS_TOKEN&quot;);

xhr.send(data);
</code></pre></div></div><div class="code-snippet js-code-snippet language-php"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-php data-lang=php>&lt;?php

$curl = curl_init();

curl_setopt_array($curl, array(
  CURLOPT_URL =&gt; &quot;https://test.hubat.net/api/v2/combinator/locations/morningcommute&quot;,
  CURLOPT_RETURNTRANSFER =&gt; true,
  CURLOPT_ENCODING =&gt; &quot;&quot;,
  CURLOPT_MAXREDIRS =&gt; 10,
  CURLOPT_TIMEOUT =&gt; 30,
  CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,
  CURLOPT_CUSTOMREQUEST =&gt; &quot;POST&quot;,
  CURLOPT_POSTFIELDS =&gt; &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;filters\&quot;:[{\&quot;field\&quot;:\&quot;data.locations.timestamp\&quot;,\&quot;transformation\&quot;:{\&quot;transformation\&quot;:\&quot;datetimeExtract\&quot;,\&quot;part\&quot;:\&quot;hour\&quot;},\&quot;operator\&quot;:{\&quot;operator\&quot;:\&quot;between\&quot;,\&quot;lower\&quot;:7,\&quot;upper\&quot;:9}}]}]&quot;,
  CURLOPT_HTTPHEADER =&gt; array(
    &quot;content-type: application/json&quot;,
    &quot;x-auth-token: ACCESS_TOKEN&quot;
  ),
));

$response = curl_exec($curl);
$err = curl_error($curl);

curl_close($curl);

if ($err) {
  echo &quot;cURL Error #:&quot; . $err;
} else {
  echo $response;
}
</code></pre></div></div><div class="code-snippet js-code-snippet language-python"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-python data-lang=python>import requests

url = &quot;https://test.hubat.net/api/v2/combinator/locations/morningcommute&quot;

payload = &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;filters\&quot;:[{\&quot;field\&quot;:\&quot;data.locations.timestamp\&quot;,\&quot;transformation\&quot;:{\&quot;transformation\&quot;:\&quot;datetimeExtract\&quot;,\&quot;part\&quot;:\&quot;hour\&quot;},\&quot;operator\&quot;:{\&quot;operator\&quot;:\&quot;between\&quot;,\&quot;lower\&quot;:7,\&quot;upper\&quot;:9}}]}]&quot;
headers = {
    'content-type': &quot;application/json&quot;,
    'x-auth-token': &quot;ACCESS_TOKEN&quot;
    }

response = requests.request(&quot;POST&quot;, url, data=payload, headers=headers)

print(response.text)
</code></pre></div></div><div class="code-snippet js-code-snippet language-ruby"><button class="btn alternative">copy</button><div class=code-snippet__selector><nav><button class=selector_switch id=raw>raw</button> <button class=selector_switch id=php>php</button> <button class=selector_switch id=ruby>ruby</button> <button class=selector_switch id=python>python</button> <button class=selector_switch id=javascript>javascript</button></nav></div><div class="code-snippet__cnt highlight"><pre><code class=language-ruby data-lang=ruby>require 'uri'
require 'net/http'

url = URI(&quot;https://test.hubat.net/api/v2/combinator/locations/morningcommute&quot;)

http = Net::HTTP.new(url.host, url.port)
http.use_ssl = true
http.verify_mode = OpenSSL::SSL::VERIFY_NONE

request = Net::HTTP::Post.new(url)
request[&quot;content-type&quot;] = 'application/json'
request[&quot;x-auth-token&quot;] = 'ACCESS_TOKEN'
request.body = &quot;[{\&quot;endpoint\&quot;:\&quot;rumpel/locations\&quot;,\&quot;filters\&quot;:[{\&quot;field\&quot;:\&quot;data.locations.timestamp\&quot;,\&quot;transformation\&quot;:{\&quot;transformation\&quot;:\&quot;datetimeExtract\&quot;,\&quot;part\&quot;:\&quot;hour\&quot;},\&quot;operator\&quot;:{\&quot;operator\&quot;:\&quot;between\&quot;,\&quot;lower\&quot;:7,\&quot;upper\&quot;:9}}]}]&quot;

response = http.request(request)
puts response.read_body
</code></pre></div></div><p>The above example extracts hour part of the location timestamp and filters for records with the hour beteen 7 amd 9. If you add multiple filters, they act like logical <code>AND</code> operator: a data record has to match all filters to be included in the result. Every <code>filter</code> consists of three fields:</p><ul><li><code>field</code> - the JSON path of the field to use for filtering - it can be a simple JSON value, an array or an object, make sure it makes sense for the filtering you are trying to do</li><li><code>transformation</code> - optionally transforms the field in question before applying a filter, with currently supported transformations including:<ul><li><code>identity</code> - keep the value as-is, effect is the same as if <code>transformation</code> was not defined</li><li><code>datetimeExtract</code> with <code>part</code> - extract part of a date from an ISO 8601 formatted date field</li><li><code>timestampExtract</code> with <code>part</code> - extract part of a date from a UNIX timestamp date field</li><li><code>searchable</code> - convert the field to searchable text. Must be used together with the <code>find</code> operator below</li></ul></li><li><code>operator</code> - the filtering operator:<ul><li><code>in</code> together with <code>value</code> field set to check if <code>field</code> is in (is contained by) <code>value</code></li><li><code>contains</code> together with <code>value</code> field set to check if <code>field</code> contains <code>value</code></li><li><code>between</code> together with <code>lower</code> and <code>upper</code> values set which checks if the <code>lower</code> &lt; <code>field</code> &lt; <code>upper</code></li><li><code>find</code> together with <code>search</code> field set to the search string to perform text-based searc on. Must be used together with the <code>searchable</code> transformation above</li></ul></li></ul><hr><p>The illustrated ways of creating data combinators hopefully provide you with a comprehensive tool to extract data in any way you like. The next step is to build up a layer of bundles on top of them to allow for retrieving a bigger variety of data in one big bundle.</p><nav class=pager-nav><a href="./">Previous Step: Overview</a> <a href=02-data-bundles.html>Next Step: Data Bundles</a></nav><hr><section class=copyright><div class=page-wrap><div><span> 2017 HAT Data Exchange Ltd.</span> <a href=/sitemap>Sitemap</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<!-- <a href="https://hubofallthings.com/main/cookie-policy/">Cookie Policy</a> --></div></div></section></section></div></div></div><script src=//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script>window.jQuery || document.write('<script src="/_bower_components/jquery/jquery.min.js"><\/script>')</script><script src=/js/script.f334.js></script></body></html>